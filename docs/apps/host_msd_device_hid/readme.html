<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <link rel="shortcut icon" href="../../favicon.ico" type="image/x-icon"> <link rel="stylesheet" href="../../assets/css/just-the-docs-default.css"> <script async src="https://www.googletagmanager.com/gtag/js?id=UA-2724382-16"></script> <script> window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'UA-2724382-16'); </script> <script type="text/javascript" src="../../assets/js/vendor/lunr.min.js"></script> <script type="text/javascript" src="../../assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.7.1 --> <title>MSD Host and HID Device Example | Harmony 3 USB Dual Role application examples</title> <meta name="generator" content="Jekyll v3.9.0" /> <meta property="og:title" content="MSD Host and HID Device Example" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="Harmony 3 USB Dual Role application examples" /> <meta property="og:description" content="Harmony 3 USB Dual Role application examples" /> <link rel="canonical" href="../../apps/host_msd_device_hid/readme.html" /> <meta property="og:url" content="../../apps/host_msd_device_hid/readme.html" /> <meta property="og:site_name" content="Harmony 3 USB Dual Role application examples" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="MSD Host and HID Device Example" /> <script type="application/ld+json"> {"publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"../../assets/images/vendor/microchip_mplab_harmony_logo_150_transparent.png"}},"@type":"WebPage","url":"../../apps/host_msd_device_hid/readme.html","headline":"MSD Host and HID Device Example","description":"Harmony 3 USB Dual Role application examples","@context":"https://schema.org"}</script> <!-- End Jekyll SEO tag --> </head> <body> <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header"> <a href="../../index.html" class="site-title lh-tight"> <div class="site-logo"></div> </a> <a href="#" id="menu-button" class="site-button"> <svg viewBox="0 0 24 24" class="icon"><use xlink:href="#svg-menu"></use></svg> </a> </div> <nav role="navigation" aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"><li class="nav-list-item active"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="../../index.html" class="nav-list-link">Harmony 3 USB Dual Role application examples</a><ul class="nav-list "><li class="nav-list-item active"><a href="../../apps/host_msd_device_hid/readme.html" class="nav-list-link active">MSD Host and HID Device Example</a></li></ul></li><li class="nav-list-item"><a href="../../release_notes.html" class="nav-list-link">Release notes</a></li><li class="nav-list-item"><a href="../../mplab_harmony_license.html" class="nav-list-link">License</a></li></ul> </nav> <footer class="site-footer"> This site uses <a href="https://github.com/pmarsceill/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll. </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search Harmony 3 USB Dual Role application examples" aria-label="Search Harmony 3 USB Dual Role application examples" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> <nav aria-label="Auxiliary" class="aux-nav"> <ul class="aux-nav-list"> <li class="aux-nav-list-item"> <a href="https://support.microchip.com" class="site-button" > Obtain Support from Microchip </a> </li> </ul> </nav> </div> <div id="main-content-wrap" class="main-content-wrap"> <nav aria-label="Breadcrumb" class="breadcrumb-nav"> <ol class="breadcrumb-nav-list"> <li class="breadcrumb-nav-list-item"><a href="../../index.html">Harmony 3 USB Dual Role application examples</a></li> <li class="breadcrumb-nav-list-item"><span>MSD Host and HID Device Example</span></li> </ol> </nav> <div id="main-content" class="main-content" role="main"> <p><a href="https://www.microchip.com"><img src="https://www.microchip.com/ResourcePackages/Microchip/assets/dist/images/logo.png" alt="MCHP" /></a></p> <h1 id="msd-host-and-hid-device-example-host_msd_device_hid"> <a href="#msd-host-and-hid-device-example-host_msd_device_hid" aria-labelledby="msd-host-and-hid-device-example-host_msd_device_hid" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> MSD Host and HID Device Example (host_msd_device_hid) </h1> <p>This application demonstrates the ability of the MPLAB Harmony USB Stack to support USB dual role operation - USB Device and Host.</p> <h2 id="description"> <a href="#description" aria-labelledby="description" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Description </h2> <p>This application creates a USB Dual Role application that can switch between USB Host MSD Stack and USB Device HID function. The role switch is trigger by a switch press. In the USB Host mode, the application performs read and write operations to a USB pen drive. In the USB Device mode, the application emulates an HID mouse.</p> <h2 id="downloading-and-building-the-application"> <a href="#downloading-and-building-the-application" aria-labelledby="downloading-and-building-the-application" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Downloading and building the application </h2> <p>To clone or download this application from Github, go to the <a href="https://github.com/Microchip-MPLAB-Harmony/usb_apps_dual_role">main page of this repository</a> and then click <strong>Clone</strong> button to clone this repository or download it as a zip file. This content can also be downloaded using content manager by following these <a href="https://github.com/Microchip-MPLAB-Harmony/contentmanager/wiki">instructions</a>.</p> <p>Path of the application within the repository is <a href="https://github.com/Microchip-MPLAB-Harmony/usb_apps_dual_role/apps/host_msd_device_hid">usb_apps_dual_role/apps/host_msd_device_hid</a>.</p> <p>The following table gives the details of project configurations, target device used, hardware, and its IDE. Open the project using the respective IDE and build it.</p> <div class="table-wrapper"><table> <thead> <tr> <th>Project Name</th> <th>IDE</th> <th>Target Device</th> <th>Hardware / Configuration</th> </tr> </thead> <tbody> <tr> <td>pic32mz_ef_curiosity_2.X</td> <td>MPLABX</td> <td>PIC32MZ2048EFM144</td> <td><a href="#config_15">Curiosity PIC32MZ EF 2.0 Development Board</a></td> </tr> <tr> <td>pic32mz_ef_sk.X</td> <td>MPLABX</td> <td>PIC32MZ2048EFH144</td> <td><a href="#config_16">PIC32MZ Embedded Connectivity with FPU (EF) Starter Kit</a></td> </tr> </tbody> </table></div> <h2 id="-configuring-the-hardware"> <a href="#-configuring-the-hardware" aria-labelledby="-configuring-the-hardware" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <a name="config_title"></a> Configuring the Hardware </h2> <h3 id="-curiosity-pic32mz-ef-20-development-board"> <a href="#-curiosity-pic32mz-ef-20-development-board" aria-labelledby="-curiosity-pic32mz-ef-20-development-board" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <a name="config_15"></a> <a href="https://www.microchip.com/Developmenttools/ProductDetails/DM320209">Curiosity PIC32MZ EF 2.0 Development Board</a> </h3> <ul> <li>Initially, the application will not operate in any role. Press the corresponding switch to change the operating role. <ul> <li>Press SW2 to change to USB Device mode.</li> <li>Press SW3 to change to USB Host mode</li> </ul> </li> <li>Device mode operation <ul> <li>Use the USB micro-B port J201 to connect the USB device to the USB Host PC.</li> <li>LED1 indicates USB Device Configuration Set Complete event (the USB device functionality has been activated by the USB Host).</li> <li>The application will emulate a USB HID mouse function. The cursor on the PC will rotate.</li> <li>Pressing SW1 will enable and disable the cursor movements.</li> </ul> </li> <li>Host mode Operation <ul> <li>Connect the USB device to the “TARGET USB” connector (J201) using a USB Type-A Female to micro-B male cable (This cable is not included in the kit).</li> <li>LED2 indicates the file write is complete.</li> </ul> </li> </ul> <h3 id="-pic32mz-embedded-connectivity-with-fpu-ef-starter-kit"> <a href="#-pic32mz-embedded-connectivity-with-fpu-ef-starter-kit" aria-labelledby="-pic32mz-embedded-connectivity-with-fpu-ef-starter-kit" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <a name="config_16"></a> <a href="https://www.microchip.com/Developmenttools/ProductDetails/DM320007">PIC32MZ Embedded Connectivity with FPU (EF) Starter Kit</a> </h3> <ul> <li>Initially, the application will not operate in any role. Press the corresponding switch to change the operating role. <ul> <li>Press SW2 to change to USB Device mode.</li> <li>Press SW3 to change to USB Host mode</li> </ul> </li> <li>Device mode operation <ul> <li>Use the micro-A/B port J6 (which is located on the bottom side of the board) to connect the USB device to the USB Host PC.</li> <li>LED1 indicates USB Device Configuration Set Complete event (the USB device functionality has been activated by the USB Host).</li> <li>The application will emulate a USB HID mouse function. The cursor on the PC will rotate. Pressing SW1 will enable and disable the cursor movements.</li> </ul> </li> <li>Host mode Operation <ul> <li>Connect the device to the Type A connector J5, which is located on the top side of the starter kit.</li> <li>LED2 indicates the file write is complete.</li> </ul> </li> </ul> <h2 id="running-the-application"> <a href="#running-the-application" aria-labelledby="running-the-application" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Running the Application </h2> <p>This application demonstrates the Dual Role capability of the MPLAB Harmony USB Stack. The application project includes both, the USB Host and Device Stacks. Both the stacks are initialized during application initialization. During operation, the application polls a switch on the starter kit to trigger a USB role switch. Note that the application cannot simultaneously operate as a host and device. The one USB role is exclusive of the other.</p> <p>Prior to using this demonstration, it is recommended to review the MPLAB Harmony USB Release Notes for any known issues.</p> <ol> <li>Open the project and in MPLAB X IDE.</li> <li>Build the code and program the device. The application initially will not operate in any USB role.</li> <li>Press SW2 on the starter kit. This places the application in a USB Device mode.</li> <li>Connect a USB cable between the micro-B USB connector on the starter kit and a PC USB host. The application will emulate a USB HID mouse function. The cursor on the PC will rotate. Pressing SW1 will enable and disable the cursor movements. Exercise device plug-n-play operation to confirm USB Device operation.</li> <li>Now try switching the USB role to Host mode. Disconnect the USB cable between the micro USB connector on the starter kit and a PC USB host. Press SW3 on the starter kit.</li> <li>The application now will be in the USB Host role. Connect a USB pen drive to the USB Host connector on the board. The application will create a file (file.txt) on the pen drive. The completion of the operation is indicated by LED2 on the starter kit. Disconnect the pen drive and connect it to a PC to verify the contents of the file.</li> <li>Repeat steps 3 through 6 to exercise the role switching capability.</li> </ol> <hr> <footer> <p class="text-small text-grey-dk-000 mb-0"><img src='https://raw.githubusercontent.com/wiki/Microchip-MPLAB-Harmony/Microchip-MPLAB-Harmony.github.io/images/microchip_logo.png' /><br />Copyright &copy; 2020 Microchip Technology.</p> <!-- <p class="text-small text-grey-dk-000 mb-0"><img src='../../assets/images/vendor/microchip_logo.png' /><br /> Copyright &copy; 2021 Microchip Technology.</p> --> </footer> </div> </div> <div class="search-overlay"></div> </div> </body> </html>
